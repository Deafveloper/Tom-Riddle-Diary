.diary-body {
    margin: 0;
    min-height: 100vh;
    font-family: "Cormorant Garamond", "Times New Roman", serif;
    background: radial-gradient(circle at top, #1b0f15 0%, #060308 60%, #020103 100%);
    color: #f7e7c1;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='32' height='32'><g transform='translate(3,3)' fill='%23f5d88f'><path d='M9.2 2.1c-.9 2.5-3.4 6.1-5.9 8.9l1.4 1.4c2.8-2.5 6.4-5 8.9-5.9-1.4 3.2-3.4 5.9-5.8 8.3l1.4 1.4c2.4-2.4 5.1-4.4 8.3-5.8-.9 2.5-3.5 6.1-5.9 8.9l1.4 1.4c2.8-2.5 6.4-5 8.9-5.9-.6 1.9-2.1 4.3-3.8 6.8l2.3.9c2-3.1 3.8-6.3 4.5-8.8.5-1.6.3-2.9-.5-3.7-.8-.8-2.1-1-3.7-.5-2.5.7-5.7 2.5-8.8 4.5l.9-2.3c2.5-1.7 4.9-3.2 6.8-3.8-.9-2.5-3.4-6.1-5.9-8.9l-1.4 1.4c2.4 2.4 4.4 5.1 5.8 8.3-1.4-3.2-3.4-5.9-5.8-8.3l-1.4 1.4c2.4 2.4 4.4 5.1 5.9 8.3-2.9-2.9-6.5-5-8.9-5.9.9-2.5 3.4-6.1 5.9-8.9l-1.4-1.4c-2.8 2.5-6.4 5-8.9 5.9.6-1.9 2-4.3 3.7-6.7l-2.3-.9C6.2 1.8 4.4 5 3.7 7.5c-.5 1.6-.3 2.9.5 3.7.8.8 2.1 1 3.7.5 2.5-.7 5.7-2.5 8.8-4.5l-.9 2.3c-2.5 1.7-4.9 3.2-6.8 3.8.9 2.5 3.4 6.1 5.9 8.9l1.4-1.4c-2.4-2.4-4.4-5.1-5.9-8.3 1.4 3.2 3.4 5.9 5.8 8.3l1.4-1.4c-2.4-2.4-4.4-5.1-5.8-8.3 2.9 2.9 6.5 5 8.9 5.9-.9 2.5-3.4 6.1-5.9 8.9l1.4 1.4c2.8-2.5 6.4-5 8.9-5.9-.6 1.9-2.1 4.3-3.8 6.8l2.3.9c2-3.1 3.8-6.3 4.5-8.8.5-1.6.3-2.9-.5-3.7-.8-.8-2.1-1-3.7-.5-2.5.7-5.7 2.5-8.8 4.5l.9-2.3c2.5-1.7 4.9-3.2 6.8-3.8-.9-2.5-3.4-6.1-5.9-8.9l-1.4 1.4c2.4 2.4 4.4 5.1 5.8 8.3-1.4-3.2-3.4-5.9-5.8-8.3l-1.4 1.4c2.4 2.4 4.4 5.1 5.8 8.3-2.9-2.9-6.5-5-8.9-5.9.9-2.5 3.4-6.1 5.9-8.9l-1.4-1.4C15.7 1.8 12.1 4.3 9.6 5.2c.6-1.8 1.9-4.1 3.4-6.4l-2.2-.9c-2.3 3.2-4 6.1-4.7 8.4-.5 1.6-.3 2.9.5 3.7.8.8 2.1 1 3.7.5 2.5-.7 5.7-2.5 8.8-4.5l-.9 2.3c-2.5 1.7-4.9 3.2-6.8 3.8z'/></g></svg>"), auto;
}

.book-intro {
    position: fixed;
    inset: 0;
    z-index: 40;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    gap: 1.8rem;
    padding: 2rem;
    pointer-events: auto;
    overflow: hidden;
    opacity: 1;
    transition: opacity 1.1s ease;
}

.book-backdrop {
    position: absolute;
    inset: 0;
    background:
        radial-gradient(circle at 50% 10%, rgba(89, 28, 40, 0.35), transparent 60%),
        radial-gradient(circle at 50% 80%, rgba(16, 8, 12, 0.85), rgba(2, 0, 1, 0.95));
    filter: blur(2px);
}

.book-wrapper {
    position: relative;
    width: min(72vw, 520px);
    aspect-ratio: 3 / 2.1;
    perspective: 1800px;
}

.book {
    position: absolute;
    inset: 0;
    transform-style: preserve-3d;
}

.book-cover,
.book-page {
    position: absolute;
    inset: 0;
    border-radius: 18px;
}

.book-cover {
    background:
        linear-gradient(135deg, rgba(58, 17, 20, 0.95), rgba(20, 5, 7, 0.98)),
        repeating-linear-gradient(120deg, rgba(133, 33, 35, 0.35) 0, rgba(133, 33, 35, 0.35) 12px, transparent 12px, transparent 28px);
    box-shadow:
        0 18px 45px rgba(0, 0, 0, 0.45),
        inset 0 0 35px rgba(0, 0, 0, 0.6);
    transform-origin: left center;
    backface-visibility: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}

.book-cover-border {
    position: absolute;
    inset: 12px;
    border-radius: 12px;
    border: 2px solid rgba(215, 145, 87, 0.4);
    box-shadow: inset 0 0 18px rgba(0, 0, 0, 0.6);
}

.book-title-crest {
    position: relative;
    font-size: clamp(1.1rem, 2vw + 0.6rem, 1.6rem);
    letter-spacing: 0.3em;
    text-transform: uppercase;
    color: rgba(238, 210, 158, 0.75);
    text-align: center;
    text-shadow:
        0 0 10px rgba(214, 162, 96, 0.4),
        0 0 20px rgba(214, 162, 96, 0.2);
}

.book-sigil {
    position: absolute;
    inset-inline: calc(50% - 36px);
    inset-block-end: 24%;
    width: 72px;
    height: 72px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(232, 184, 129, 0.35), transparent 70%);
    box-shadow: 0 0 22px rgba(235, 189, 140, 0.4);
}

.book-page {
    background:
        linear-gradient(135deg, rgba(229, 203, 160, 0.94), rgba(183, 152, 118, 0.9));
    transform: rotateY(-180deg) translateZ(-2px);
    backface-visibility: hidden;
    box-shadow:
        inset 0 0 45px rgba(71, 53, 39, 0.3),
        0 0 30px rgba(0, 0, 0, 0.45);
}

.page-glow {
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background:
        radial-gradient(circle at 30% 25%, rgba(255, 250, 232, 0.35), transparent 60%),
        radial-gradient(circle at 70% 75%, rgba(255, 244, 214, 0.25), transparent 70%);
    opacity: 0;
}

.page-runes {
    position: absolute;
    inset: 18%;
    background-image: repeating-linear-gradient(90deg, rgba(81, 52, 36, 0.2) 0, rgba(81, 52, 36, 0.2) 1px, transparent 1px, transparent 24px);
    opacity: 0;
}

.book-whisper {
    position: relative;
    font-size: clamp(0.9rem, 1vw + 0.5rem, 1.1rem);
    letter-spacing: 0.16em;
    text-transform: uppercase;
    color: rgba(229, 206, 172, 0.65);
    text-shadow:
        0 0 12px rgba(214, 163, 96, 0.4),
        0 0 24px rgba(120, 17, 26, 0.3);
    animation: whisperPulse 2.8s ease-in-out infinite;
    pointer-events: none;
}

.intro-motes {
    position: absolute;
    inset: 0;
    background-image:
        radial-gradient(1.5px 1.5px at 20% 30%, rgba(255, 240, 190, 0.6), transparent 60%),
        radial-gradient(1.5px 1.5px at 60% 70%, rgba(255, 220, 170, 0.55), transparent 60%),
        radial-gradient(1px 1px at 80% 40%, rgba(255, 244, 214, 0.4), transparent 60%),
        radial-gradient(1.2px 1.2px at 35% 80%, rgba(212, 148, 90, 0.4), transparent 60%);
    opacity: 0.6;
    mix-blend-mode: screen;
    animation: introDust 18s linear infinite;
}

.book-intro.open .book-cover {
    animation: coverOpen 3.3s ease forwards;
}

.book-intro.open .page-glow,
.book-intro.open .page-runes {
    animation: pageReveal 2.4s ease forwards 0.6s;
}

.book-intro.fade-out {
    opacity: 0;
    pointer-events: none;
}

body.intro-active .diary-shell {
    opacity: 0;
    pointer-events: none;
    transform: translateY(30px);
}

body.intro-active .particle-field {
    opacity: 0;
}

.particle-field::before,
.particle-field::after {
    content: "";
    position: absolute;
    inset: 0;
    background-image: radial-gradient(2px 2px at 12% 20%, rgba(255, 245, 214, 0.55), transparent 60%), radial-gradient(1.5px 1.5px at 38% 78%, rgba(255, 233, 186, 0.45), transparent 60%), radial-gradient(1.4px 1.4px at 65% 15%, rgba(255, 255, 255, 0.5), transparent 60%), radial-gradient(1.6px 1.6px at 82% 52%, rgba(244, 215, 164, 0.4), transparent 60%), radial-gradient(1.2px 1.2px at 24% 64%, rgba(255, 215, 180, 0.45), transparent 60%), radial-gradient(1.4px 1.4px at 70% 85%, rgba(255, 210, 180, 0.35), transparent 60%);
    opacity: 0.35;
    mix-blend-mode: screen;
    animation: drift 24s linear infinite;
}

.particle-field::after {
    animation-duration: 32s;
    animation-direction: reverse;
}

.particle-field {
    position: fixed;
    inset: 0;
    pointer-events: none;
    opacity: 0.85;
    transition: opacity 1.2s ease;
}

.diary-shell {
    width: min(90vw, 640px);
    padding: 2rem;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    z-index: 1;
    opacity: 1;
    transform: translateY(0);
    transition: opacity 1s ease, transform 1s ease;
}

.diary-cover {
    position: relative;
    width: 100%;
    background:
        linear-gradient(145deg, rgba(24, 10, 12, 0.96), rgba(9, 4, 6, 0.92)),
        repeating-linear-gradient(120deg, rgba(55, 16, 22, 0.25) 0, rgba(55, 16, 22, 0.25) 12px, transparent 12px, transparent 24px);
    border: 2px solid rgba(133, 16, 24, 0.6);
    border-radius: 18px;
    padding: 1.5rem;
    box-shadow:
        0 0 25px rgba(158, 18, 53, 0.4),
        inset 0 0 30px rgba(0, 0, 0, 0.8);
    overflow: hidden;
}

.diary-cover::before {
    content: "";
    position: absolute;
    inset: 12px;
    border-radius: 12px;
    background:
        radial-gradient(circle at 30% 20%, rgba(203, 152, 89, 0.2), transparent 55%),
        radial-gradient(circle at 70% 80%, rgba(133, 16, 24, 0.35), transparent 60%),
        linear-gradient(120deg, rgba(32, 15, 11, 0.9), rgba(12, 6, 4, 0.85));
    pointer-events: none;
    filter: blur(2px);
}

.diary-title {
    position: relative;
    text-align: center;
    letter-spacing: 0.25rem;
    text-transform: uppercase;
    font-size: 1.2rem;
    color: rgba(236, 197, 126, 0.8);
    margin-bottom: 1rem;
    text-shadow:
        0 0 12px rgba(165, 63, 52, 0.8),
        0 0 22px rgba(217, 148, 53, 0.6);
}

.ink-surface {
    position: relative;
    min-height: 240px;
    max-height: 360px;
    overflow-y: auto;
    padding: 2rem 1.5rem 1.5rem;
    margin-bottom: 1rem;
    background:
        linear-gradient(180deg, rgba(36, 16, 20, 0.88), rgba(15, 6, 8, 0.95)),
        repeating-radial-gradient(circle at 20% 20%, rgba(220, 180, 120, 0.06) 0, rgba(220, 180, 120, 0.06) 4px, transparent 4px, transparent 12px);
    border-radius: 12px;
    border: 1px solid rgba(244, 215, 164, 0.15);
    box-shadow:
        inset 0 0 20px rgba(0, 0, 0, 0.7),
        inset 0 0 60px rgba(75, 14, 14, 0.5);
}

.entry {
    position: relative;
    margin: 0;
    font-size: 1.05rem;
    line-height: 1.6;
    letter-spacing: 0.03em;
    word-break: break-word;
    white-space: pre-wrap;
}

.entry::before {
    content: "";
    position: absolute;
    inset: -12px;
    background: radial-gradient(circle at 50% 0%, rgba(207, 154, 77, 0.18), transparent 60%);
    opacity: 0;
    animation: halo 3.2s ease forwards;
}

.entry.user-ink {
    color: rgba(234, 204, 154, 0.85);
    font-style: italic;
    animation: inkFade 2.8s ease forwards;
}

.entry.riddle-ink {
    color: rgba(244, 215, 164, 0.95);
    text-shadow: 0 0 10px rgba(224, 105, 75, 0.55);
    animation: floatPulse 6s ease-in-out infinite;
}

.entry.riddle-ink.secret {
    color: rgba(215, 59, 59, 0.95);
    text-shadow:
        0 0 14px rgba(235, 78, 78, 0.7),
        0 0 28px rgba(122, 14, 14, 0.7);
}

.caret {
    display: inline-block;
    width: 0.05em;
    height: 1em;
    background: currentColor;
    margin-left: 0.05em;
    animation: blink 0.9s steps(1) infinite;
}

#diary-form {
    position: relative;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background: rgba(12, 5, 7, 0.75);
    border-radius: 999px;
    border: 1px solid rgba(214, 187, 136, 0.2);
    box-shadow:
        inset 0 0 12px rgba(0, 0, 0, 0.8),
        0 0 15px rgba(140, 29, 45, 0.4);
    padding: 0.6rem 1rem 0.6rem 1.25rem;
}

#ink-input {
    flex: 1;
    resize: none;
    border: none;
    background: transparent;
    font-family: inherit;
    font-size: 1rem;
    color: rgba(240, 215, 172, 0.95);
    outline: none;
    line-height: 1.4;
    caret-color: rgba(214, 104, 81, 0.9);
}

#ink-input::placeholder {
    color: rgba(240, 215, 172, 0.45);
    letter-spacing: 0.02em;
}

.quill-glow {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(244, 215, 164, 0.45), rgba(214, 16, 60, 0.15) 70%, transparent 100%);
    position: relative;
    animation: orbit 3.5s ease-in-out infinite;
    pointer-events: none;
}

.quill-glow::after {
    content: "";
    position: absolute;
    inset: 12px;
    background: radial-gradient(circle, rgba(244, 215, 164, 0.65), transparent 80%);
    border-radius: 50%;
    filter: blur(1px);
}

.visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

@keyframes coverOpen {
    0% {
        transform: rotateY(0deg);
    }
    35% {
        transform: rotateY(-120deg);
    }
    60% {
        transform: rotateY(-175deg);
    }
    78% {
        transform: rotateY(-168deg);
    }
    100% {
        transform: rotateY(-180deg);
    }
}

@keyframes pageReveal {
    0% {
        opacity: 0;
        transform: scale(0.96);
    }
    40% {
        opacity: 0.65;
        transform: scale(1.02);
    }
    100% {
        opacity: 0.9;
        transform: scale(1);
    }
}

@keyframes introDust {
    0% {
        transform: translate3d(0, 0, 0) scale(1);
    }
    50% {
        transform: translate3d(2%, -4%, 0) scale(1.05);
    }
    100% {
        transform: translate3d(-3%, 6%, 0) scale(1);
    }
}

@keyframes whisperPulse {
    0%, 100% {
        opacity: 0.45;
        letter-spacing: 0.1em;
    }
    50% {
        opacity: 0.8;
        letter-spacing: 0.2em;
    }
}

@keyframes drift {
    0% {
        transform: translate3d(0, 0, 0) scale(1);
    }
    50% {
        transform: translate3d(-2%, -4%, 0) scale(1.05);
    }
    100% {
        transform: translate3d(3%, 5%, 0) scale(1);
    }
}

@keyframes inkFade {
    0% {
        opacity: 0;
        transform: translateY(8px) scale(0.98);
    }
    15% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
    70% {
        opacity: 0.95;
    }
    100% {
        opacity: 0;
        transform: translateY(-8px) scale(0.96);
    }
}

@keyframes floatPulse {
    0%, 100% {
        transform: translateY(0);
        opacity: 0.95;
    }
    50% {
        transform: translateY(-6px);
        opacity: 1;
    }
}

@keyframes halo {
    0% {
        opacity: 0;
        transform: scale(0.9);
    }
    40% {
        opacity: 0.4;
    }
    100% {
        opacity: 0;
        transform: scale(1.1);
    }
}

@keyframes blink {
    0%, 50% {
        opacity: 1;
    }
    51%, 100% {
        opacity: 0;
    }
}

@keyframes orbit {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-5px);
    }
}

@media (max-width: 600px) {
    .book-wrapper {
        width: min(88vw, 420px);
    }
    .book-whisper {
        letter-spacing: 0.12em;
        font-size: 0.85rem;
    }
    .diary-shell {
        padding: 1.2rem;
    }
    .ink-surface {
        min-height: 200px;
        padding: 1.5rem 1.25rem;
    }
}
